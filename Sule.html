<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suleiman Project</title>
    <link rel="stylesheet" href="code.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="main">
        <center>
   
            <div class="line">
                <h3>HIZBULLAH ACADEMY<br>Comprehensive List For [SULEIMAN]</h3>
                <h5>Please fill the form and make sure you <br>write student name properly!</h5>
            </div><br>
            <div class="status"><span id="greeting"></span></div>
            <br>
            <form name="submit-to-google-sheet">
                <div class="form">
                    <center><img src="islamiyya.png" width="100px"></center>
                    <div class="form-control">
                        <input type="text" name="name" placeholder="Student Name" autocapitalize="characters" required>
                    </div> 
                    <div class="form-control">
                        <input type="number" name="adm" placeholder="Reg.no." required>
                    </div>
                    <div class="button">
                        <button class="save-btn" name="submit" id="button"><b>Submit</b></button>
                    </div>
                    <br>
                    <div style="width:60px; height:60px; position:fixed; right:7px; bottom:7px;"> <a href="https://wa.me/message/SVGL272624AIB1"> <img src="whatsapp.png" style="width:40px; height:40px;" /> </a> </div>
                    <!-- Social media icons -->
                    <h6>Contact us</h6>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/profile.php?id=100079363953453"><i class="fab fa-facebook" target="_blank"></i></a>
                        
                    </div>
                    
                                                      <div <a href="https://wa.me/message/SVGL272624AIB1">  <img src="" style="width:70px;" /> </a> </div>
                    <!-- Social media icons -->
                    <div class="hint"><a href="tel:0916184820">Report</a></div>
                </div>
            </form>
        </center>
    </div>
    
    <script>
        // Get current hour
        var currentHour = new Date().getHours();

        // Define greeting messages
        var greetingMessage = "";

        if (currentHour < 12) {
            greetingMessage = "Good Morning!";
        } else if (currentHour < 18) {
            greetingMessage = "Good Afternoon!";
        } else {
            greetingMessage = "Good Evening!";
        }

        // Display greeting message in the HTML element with id "greeting"
        document.getElementById("greeting").innerHTML = greetingMessage;
    </script>

    <script>
        const sheetName = 'Sheet1'
const scriptProp = PropertiesService.getScriptProperties()

function initialSetup () {
  const activeSpreadsheet = SpreadsheetApp.getActiveSpreadsheet()
  scriptProp.setProperty('key', activeSpreadsheet.getId())
}

function doPost (e) {
  const lock = LockService.getScriptLock()
  lock.tryLock(10000)

  try {
    const doc = SpreadsheetApp.openById(scriptProp.getProperty('https://docs.google.com/spreadsheets/d/1r8Xy1K9BpNY-kn3TtDzEif_3nA96N5WUW4ZOCIGhckM/edit?usp=drivesdk'))
    const sheet = doc.getSheetByName(sheetName)

    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0]
    const nextRow = sheet.getLastRow(1) + 1

    const newRow = headers.map(function(header) {
      return header === 'Date' ? new Date() : e.parameter[header]
    })

    sheet.getRange(nextRow, 1, 1, newRow.length).setValues([newRow])

    return ContentService
      .createTextOutput(JSON.stringify({ 'result': 'success', 'row': nextRow }))
      .setMimeType(ContentService.MimeType.JSON)
  }

  catch (e) {
    return ContentService
      .createTextOutput(JSON.stringify({ 'result': 'error', 'error': e }))
      .setMimeType(ContentService.MimeType.JSON)
  }

  finally {
    lock.releaseLock()
  }
        }
    </script>
    
</body>
</html>
